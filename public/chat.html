<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset=utf-8>
	<meta name=viewport content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<title>RoundChat</title>
	<style>
		:root {
			--bg-color: #f0f0eb;
			--chat-bg: #fff;
			--primary-color: #555;
			--text-color: #2b2b2b;
			--border-color: #888;
			--accent-h1: #000080;
			--accent-ui: #e8e8e8;
			--msg-bg: #fff;
			--header-bg: #fff;
			--input-bg: #fff;
			--shadow-color: #ccc;
		}

		:root.dark {
			--bg-color: #1a1a2e;
			--chat-bg: #16213e;
			--primary-color: #aaa;
			--text-color: #e0e0e0;
			--border-color: #444;
			--accent-h1: #4da6ff;
			--accent-ui: #2a2a4a;
			--msg-bg: #1e293b;
			--header-bg: #0f172a;
			--input-bg: #1e293b;
			--shadow-color: #0a0a15;
		}

		html {
			margin: 0;
			padding: 0;
			height: 100%;
		}

		body {
			height: 100vh;
			height: -webkit-fill-available;
			box-sizing: border-box;
			margin: 0;
			padding: 1.5em;
			font-family: 'Geneva', 'Verdana', sans-serif;
			font-size: 15px;
			color: var(--text-color);
			display: flex;
			flex-direction: column;
			background: var(--bg-color);
			gap: 0.8em;
			transition: background 0.3s, color 0.3s;
		}

		/* Modern Retro Buttons */
		button {
			background: #e0e0e0;
			border: 1px solid #999;
			border-bottom: 2px solid #555;
			border-right: 2px solid #555;
			border-radius: 4px;
			color: #333;
			font-family: inherit;
			font-weight: 600;
			cursor: pointer;
			transition: all 0.1s ease;
			text-transform: uppercase;
			letter-spacing: 0.5px;
			font-size: 0.8em;
		}

		.dark button {
			background: #374151;
			border-color: #4b5563;
			color: #e0e0e0;
		}

		button:active {
			border: 1px solid #999;
			transform: translate(1px, 1px);
			background: #ccc;
		}

		/* Center container for Room Input */
		#room-selection {
			flex: 1;
			display: flex;
			flex-direction: column;
			justify-content: center;
			align-items: center;
			gap: 1.5em;
		}

		#room-selection h1 {
			font-family: 'Courier New', monospace;
			color: var(--text-color);
			text-shadow: 2px 2px 0 var(--shadow-color);
		}

		#room-selection input {
			width: 100%;
			max-width: 320px;
			padding: 1em;
			border: 2px solid var(--border-color);
			border-radius: 6px;
			background: var(--input-bg);
			color: var(--text-color);
			box-shadow: 4px 4px 0 var(--shadow-color);
		}

		#room-selection button {
			padding: 0.8em 2.5em;
			font-size: 1em;
			background: #000080;
			color: #fff;
			border: none;
			box-shadow: 3px 3px 0 rgba(0, 0, 0, 0.3);
		}

		.dark #room-selection button {
			background: #4da6ff;
			color: #000;
		}

		#room-selection button:active {
			box-shadow: 1px 1px 0 rgba(0, 0, 0, 0.3);
			transform: translate(2px, 2px);
		}

		/* Main Chat UI */
		#chat-interface {
			display: none;
			flex: 1;
			flex-direction: column;
			height: 100%;
			gap: 0.8em;
			max-width: 800px;
			margin: 0 auto;
			width: 100%;
		}

		header {
			flex: 0 0 auto;
			display: flex;
			justify-content: space-between;
			align-items: center;
			flex-wrap: wrap;
			background: var(--header-bg);
			color: var(--text-color);
			padding: 0.8em 1em;
			border: 2px solid var(--border-color);
			border-radius: 8px;
			box-shadow: 4px 4px 0 var(--shadow-color);
		}

		h1 {
			margin: 0;
			font-size: 1.25em;
			flex-grow: 1;
			font-family: 'Courier New', monospace;
			font-weight: 700;
			color: var(--accent-h1);
		}

		.room-info {
			font-size: 0.9em;
			display: flex;
			flex-direction: row;
			align-items: center;
			gap: 1em;
		}

		.room-info span {
			color: var(--text-color);
			background: var(--accent-ui);
			padding: 2px 5px;
			border-radius: 4px;
			font-family: monospace;
		}

		#passkey-display {
			font-size: 0.9em;
		}

		.controls {
			display: flex;
			gap: 0.5em;
			align-items: center;
		}

		button.small-btn {
			padding: 4px 8px;
			font-size: 0.7em;
			border-radius: 3px;
		}

		button.logout-btn {
			background: #ffe0e0;
			border-color: #ffcccc;
			color: #d00;
		}

		#online-users {
			flex: 0 0 auto;
			font-size: 0.85em;
			color: var(--text-color);
			white-space: nowrap;
			overflow-x: auto;
			padding: 6px 10px;
			min-height: 1.4em;
			background: transparent;
		}

		#online-users span {
			display: inline-block;
			margin-right: 0.8em;
			color: var(--accent-h1);
			font-weight: bold;
		}

		/* Typing indicator */
		#typing-indicator {
			font-size: 0.8em;
			color: var(--primary-color);
			font-style: italic;
			min-height: 1.2em;
			padding: 0 10px;
		}

		ul#messages {
			flex: 1 1 auto;
			overflow-y: auto;
			margin: 0;
			padding: 1em;
			list-style: none;
			background: var(--chat-bg);
			border: 2px solid var(--border-color);
			border-radius: 8px;
			box-shadow: inset 2px 2px 5px rgba(0, 0, 0, 0.05);
			display: flex;
			flex-direction: column;
			color: var(--text-color);
		}

		ul#messages li {
			margin: 0.4em 0;
			padding: 8px 10px;
			word-wrap: break-word;
			line-height: 1.4;
			background: var(--msg-bg);
			border-radius: 6px;
			border: 1px solid var(--border-color);
			position: relative;
		}

		ul#messages li:hover {
			background: var(--accent-ui);
		}

		ul#messages li small {
			display: inline-block;
			font-size: 0.85em;
			color: var(--accent-h1);
			margin-right: 0.5em;
		}

		ul#messages li .msg-content {
			display: block;
			margin-top: 4px;
		}

		ul#messages li.pending {
			opacity: 0.6;
			font-style: italic;
		}

		/* Message reactions */
		.msg-reactions {
			display: flex;
			gap: 4px;
			margin-top: 6px;
			flex-wrap: wrap;
		}

		.reaction-btn {
			background: var(--accent-ui);
			border: 1px solid var(--border-color);
			border-radius: 12px;
			padding: 2px 6px;
			font-size: 0.75em;
			cursor: pointer;
			display: flex;
			align-items: center;
			gap: 3px;
		}

		.reaction-btn:hover {
			background: var(--shadow-color);
		}

		.reaction-btn.active {
			background: var(--accent-h1);
			color: white;
		}

		.add-reaction-btn {
			background: transparent;
			border: 1px dashed var(--border-color);
			border-radius: 12px;
			padding: 2px 8px;
			font-size: 0.75em;
			cursor: pointer;
			opacity: 0;
			transition: opacity 0.2s;
		}

		ul#messages li:hover .add-reaction-btn {
			opacity: 1;
		}

		/* Reaction picker */
		.reaction-picker {
			position: absolute;
			bottom: 100%;
			left: 0;
			background: var(--msg-bg);
			border: 2px solid var(--border-color);
			border-radius: 8px;
			padding: 6px;
			display: none;
			gap: 4px;
			z-index: 100;
			box-shadow: 2px 2px 8px rgba(0, 0, 0, 0.2);
		}

		.reaction-picker.show {
			display: flex;
		}

		.reaction-picker button {
			background: transparent;
			border: none;
			font-size: 1.2em;
			padding: 4px 8px;
			cursor: pointer;
			border-radius: 4px;
		}

		.reaction-picker button:hover {
			background: var(--accent-ui);
		}

		/* Read receipts */
		.read-receipt {
			font-size: 0.7em;
			color: var(--primary-color);
			margin-left: 6px;
		}

		.read-receipt.read {
			color: #22c55e;
		}

		/* Input Form */
		form {
			flex: 0 0 auto;
			margin: 0;
		}

		form p {
			margin: 0;
			display: flex;
			gap: 0.5em;
		}

		form input[name=name] {
			flex: 0 0 auto;
			width: 100px;
		}

		form input {
			flex: 1;
			padding: 0.7em;
			border: 2px solid var(--border-color);
			border-radius: 6px;
			background: var(--input-bg);
			color: var(--text-color);
			font-size: 1em;
		}

		button#action-btn {
			padding: 0.7em 1.5em;
			background: #000080;
			color: white;
			border: none;
			box-shadow: 3px 3px 0 #444;
		}

		.dark button#action-btn {
			background: #4da6ff;
			color: #000;
		}

		button#action-btn:active {
			box-shadow: 1px 1px 0 #444;
			transform: translate(2px, 2px);
		}

		button#action-btn:disabled {
			background: #777;
			box-shadow: none;
			transform: none;
		}

		.sound-toggle {
			font-size: 0.8em;
			display: flex;
			align-items: center;
			gap: 4px;
			cursor: pointer;
			color: var(--text-color);
		}

		#form-status {
			font-size: 0.85em;
			color: #d00;
			font-weight: bold;
			padding-bottom: 4px;
			min-height: 1.2em;
		}

		/* User bar */
		.user-bar {
			position: fixed;
			top: 0;
			left: 0;
			right: 0;
			background: rgba(0, 0, 0, 0.85);
			color: white;
			padding: 10px 16px;
			display: flex;
			justify-content: space-between;
			align-items: center;
			font-size: 0.9em;
			z-index: 1000;
		}

		.user-bar .user-info {
			display: flex;
			align-items: center;
			gap: 8px;
		}

		.user-bar .user-name {
			font-weight: 600;
		}

		.user-bar .guest-badge {
			background: #6b7280;
			color: white;
			padding: 2px 8px;
			border-radius: 10px;
			font-size: 0.75em;
		}

		.user-bar .logged-in-badge {
			background: #22c55e;
			color: white;
			padding: 2px 8px;
			border-radius: 10px;
			font-size: 0.75em;
			display: none;
		}

		.user-bar button {
			background: transparent;
			border: 1px solid rgba(255, 255, 255, 0.3);
			color: white;
			padding: 6px 12px;
			font-size: 0.85em;
		}

		.user-bar button:hover {
			background: rgba(255, 255, 255, 0.1);
		}

		/* Settings button */
		.settings-btn {
			background: transparent !important;
			border: none !important;
			font-size: 1.2em !important;
			padding: 4px 8px !important;
			cursor: pointer;
		}

		/* Settings modal */
		.settings-modal {
			display: none;
			position: fixed;
			top: 0;
			left: 0;
			right: 0;
			bottom: 0;
			background: rgba(0, 0, 0, 0.5);
			z-index: 2000;
			justify-content: center;
			align-items: center;
		}

		.settings-modal.show {
			display: flex;
		}

		.settings-content {
			background: var(--chat-bg);
			border: 2px solid var(--border-color);
			border-radius: 12px;
			padding: 24px;
			width: 90%;
			max-width: 400px;
			color: var(--text-color);
		}

		.settings-content h2 {
			margin-top: 0;
			color: var(--accent-h1);
		}

		.settings-section {
			margin: 20px 0;
		}

		.settings-section h3 {
			margin: 0 0 10px 0;
			font-size: 0.9em;
			color: var(--primary-color);
		}

		.theme-options {
			display: flex;
			gap: 10px;
			flex-wrap: wrap;
		}

		.theme-option {
			width: 40px;
			height: 40px;
			border-radius: 50%;
			border: 3px solid transparent;
			cursor: pointer;
			transition: transform 0.2s;
		}

		.theme-option:hover {
			transform: scale(1.1);
		}

		.theme-option.active {
			border-color: var(--accent-h1);
		}

		.toggle-switch {
			display: flex;
			align-items: center;
			gap: 10px;
			cursor: pointer;
		}

		.toggle-switch input {
			width: 40px;
			height: 20px;
		}

		body {
			padding-top: 50px !important;
		}
	</style>
</head>

<body>
	<!-- User Bar -->
	<div class="user-bar" id="user-bar">
		<div class="user-info">
			<span>üë§</span>
			<span class="user-name" id="user-display-name">Guest</span>
			<span class="guest-badge" id="guest-badge">Guest</span>
			<span class="logged-in-badge" id="logged-in-badge">‚úì Logged In</span>
		</div>
		<div style="display:flex; gap:8px; align-items:center;">
			<button class="settings-btn" id="settings-btn" title="Settings">‚öôÔ∏è</button>
			<button id="signout-btn">Sign Out</button>
		</div>
	</div>

	<!-- Settings Modal -->
	<div class="settings-modal" id="settings-modal">
		<div class="settings-content">
			<h2>‚öôÔ∏è Settings</h2>

			<div class="settings-section">
				<h3>üåô Dark Mode</h3>
				<label class="toggle-switch">
					<input type="checkbox" id="dark-mode-toggle">
					<span>Enable Dark Mode</span>
				</label>
			</div>

			<div class="settings-section">
				<h3>üé® Theme Colors</h3>
				<div class="theme-options">
					<div class="theme-option active" data-theme="default"
						style="background: linear-gradient(135deg, #000080, #0066cc);" title="Navy Blue"></div>
					<div class="theme-option" data-theme="purple"
						style="background: linear-gradient(135deg, #7c3aed, #a855f7);" title="Purple"></div>
					<div class="theme-option" data-theme="green"
						style="background: linear-gradient(135deg, #059669, #10b981);" title="Emerald"></div>
					<div class="theme-option" data-theme="red"
						style="background: linear-gradient(135deg, #dc2626, #f87171);" title="Red"></div>
					<div class="theme-option" data-theme="orange"
						style="background: linear-gradient(135deg, #ea580c, #fb923c);" title="Orange"></div>
					<div class="theme-option" data-theme="pink"
						style="background: linear-gradient(135deg, #db2777, #f472b6);" title="Pink"></div>
				</div>
			</div>

			<button id="close-settings" style="width:100%; margin-top:20px; padding:12px;">Close</button>
		</div>
	</div>

	<!-- Initial Room Selection Screen -->
	<div id="room-selection">
		<h1 style="font-family:'Courier New'; text-shadow: 2px 2px 0 var(--shadow-color); margin-bottom: 0.5em;">üí¨
			RoundChat</h1>
		<button id="world-chat-btn" style="background:#0066cc; width:100%; max-width:320px; font-size:1.1em;">üåé Enter
			World
			Chat</button>

		<div style="display:flex; align-items:center; gap:10px; width:100%; max-width:320px; margin: 10px 0;">
			<hr style="flex:1; border:0; border-top:1px solid var(--border-color);">
			<span style="color:var(--primary-color); font-size:0.9em;">OR</span>
			<hr style="flex:1; border:0; border-top:1px solid var(--border-color);">
		</div>

		<h2 style="font-family:'Courier New'; color:var(--text-color); font-size:1.1em; margin:0;">Create / Join Room
		</h2>
		<input type="text" id="initial-room-input" placeholder="Room Name" autofocus>
		<button id="set-room-btn">Next</button>
	</div>

	<!-- Main Chat Interface -->
	<div id="chat-interface">
		<header>
			<h1 id="header-title">Simple Chat</h1>

			<div id="room-controls" class="room-info" style="display: none;">
				<div class="controls">
					<label class="sound-toggle">
						<input type="checkbox" id="sound-toggle" checked> üîä
					</label>
					<button class="small-btn" id="clear-btn">Clear Chat</button>
					<button class="small-btn logout-btn" id="logout-btn">Exit Room</button>
				</div>
				<div id="passkey-display" style="margin-top:4px;">üîë <span id="pk-val">***</span></div>
			</div>
		</header>

		<div id="online-users">
			<!-- J.Doe, M.Smith... -->
		</div>

		<div id="typing-indicator"></div>

		<!-- Messages List -->
		<ul id=messages>
			<li id="status-message">Please join the room...</li>
			<template>
				<li class=pending>
					<small>‚Ä¶</small>
					<span class="msg-content">‚Ä¶</span>
					<div class="msg-reactions"></div>
					<div class="reaction-picker">
						<button data-emoji="üëç">üëç</button>
						<button data-emoji="‚ù§Ô∏è">‚ù§Ô∏è</button>
						<button data-emoji="üòÇ">üòÇ</button>
						<button data-emoji="üòÆ">üòÆ</button>
						<button data-emoji="üò¢">üò¢</button>
					</div>
				</li>
			</template>
		</ul>

		<!-- Form -->
		<form id="chat-form">
			<div id="form-status"></div>
			<p>
				<input type=text name=name placeholder="Name" value="" required autocomplete="username">
				<input type=text id="main-input" name=content placeholder="Message" disabled autocomplete="off">
				<button id="action-btn">Join</button>
			</p>
		</form>
	</div>

	<script type="module" src="script.js"></script>
</body>

</html>